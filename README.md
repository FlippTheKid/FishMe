# FishMe
Телеграм бот, распознающий вид рыбы на фото
С помощью предобученной архитектуры Transformer решил задачу CV классификации рыб. Для реализации проекта, мною была использована ViTForImageClassification from transformers с зафайнтьюненым последним слоем, а так же собственноручно собранный датасет. Модель была обучена распознавать 13 видов речных рыб России по фото и успешно протестирована мною на собственных уловах. На валидационной выборке достигнута accuracy=97%.

Мое увлечение рыбалкой привело меня к тому, что я решил создать бота-помощника для начинающего рыболова.
Довольно много времени я потратил на сбор подходящих фотографий. Собранный мною датасет состоит из 1300 фото - по 100 на каждый вид. Было бы неплохо сделать его больше для повышения точности, однако и этого вполне хватило. 

По мере выполнения проекта, я столкнулся со множеством трудностей, которые я постараюсь в кратце описать далее.
Собрав датасет, нужно было предобработать данные: приведение к определенному размеру, а так же к формату RGB (по началу, не сделав этого, возникла ошибка с 4м каналом (RGBA), тогда как ожидалось всего 3). 
Затем я взял  ViTForImageClassification from transformer, изменил последний слой под свою задачу, выбрал оптимайзер, лосс итд и впервые попробовал обучить. Протестировав модель внутри проекта, понял, что результат вполне неплохой. Сохранив модель, я поменял среду выполнения с GPU на CPU, попробовал выгрузить ее с уже обученными весами и перевести в режим предсказания. В этот момент повторного тестирования, я не получил ни одного правильного ответва)) Ошибка заключалась в том, что перезапустив проект, у меня заново произошло деление на val и train выборки, в следствие чего метки классов лейбл-энкодера обученные на предыдущих данных просто не соответствовали новым. В итоге, я сохранил train_files.pkl, val_files.pkl, label_encoder.pkl в отдельные файлы, а так же вытащил само обучения лейбл-энкодера из class FishDataset(Dataset). Это дало мне  гарантию, что при загрузке обученной модели и предсказании меток классов, будет использовано то же самое разделение данных и та же самая кодировка меток, что и при обучении.

Далее, мне пришлось вспомнить свой опыт в создании телеграм ботов. Будучи школьником 11-ти классником, написал тг бота, который парсил данный с сайта InvestCom о стоимости акций москбиржи и строил графики текущей стоимости по запросам.  Тогда я думал о том, как создать такого бота, который сможет предсказывать стоимость акций, а так же предупреждать, когда стоит продавать, а когда покупать. Но что такое машинное обучение, я тогда не знал, и математического аппарата мне тогда не хватило:) Зато теперь с легкостью смог интегрировать проект в телеграм. 

Cкриншоты работоспособности телебота приведены выше (1-7.jpg)
